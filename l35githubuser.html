<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <title>Github Users</title>
    <style>
        body{
            height: 100vh;
            background-color: #f4f4f4;

            display: flex;
            justify-content: center;
            align-items: center;
        }
        .card-body{
            width: 100%;
        }
    

    </style>
</head>
<body>
    <div class="container">
       <div class="col-md-6 mx-auto">
        <div class="card rounded-0">
            <div class="card-header">
                <form id="form" action="" method="">
                    <div class="form-group">
                        <input type="text" name="search" id="search" class="form-control form-control-sm" placeholder="Search..." autocomplete="off"/>

                    </div>
                </form>

            </div>
            <div id="displayone" class="card-body">
                <!-- <img src="" class="rounded-circle"  alt="userimg" />
                <h3 class="card-title">User Name</h3>
                <p class="card-subtitle">Bio</p>

                <ul class="list-group">
                    <li class="list-group-item">Repositories : <span class="fw-bold">100</span> </li>
                    <li class="list-group-item">Followers : <span class="fw-bold">200</span> </li>
                    <li class="list-group-item">Following : <span class="fw-bold">300</span> </li>

                </ul> -->

            </div>
            <div id="displaytwo" class="card-footer">
                <div class="dropdown float-end">
                    <a href="javascript:void(0);" class="btn btn-success btn-sm rounded-0 dropdown-toggle" data-bs-toggle="dropdown">Repository Links</a>
                    <ul id="displaylistgroup" class="dropdown-menu">
                        <!-- <li><a href="javascript:void(0);" class="dropdown-item" target="_blank">Sample</a></li> -->
                    </ul>

                </div>

            </div>
        </div>

       </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        const getform = document.getElementById('form');
        const getsearch = document.getElementById('search');
        const getdisplayone = document.getElementById('displayone');
        const getdisplaytwo = document.getElementById('displaytwo');
        const getdisplaylistgroup = document.getElementById('displaylistgroup');

        getform.addEventListener('submit',(e)=>{
            e.preventDefault();

            const getusername = getsearch.value;
            console.log(getusername);

            if(getusername.trim()){
                getresult(getusername);
                getsearch.value = "";
                getsearch.focus();
            }else{
                window.alert("Please enter a search value");
            }
        });

        const url = `https://api.github.com/users/`;

        getresult('datalandtechnology');
        function getresult(username){
            // console.log(username);

            axios({
                method:"GET",
                url: url+username
            }).then((response)=>{
                // console.log(response);
                // console.log(typeof response);

                const {data} = response
                // console.log(data);

                cardbodytodom(data);
                resultrepos(username);

            }).catch((err)=>{
                console.log(err);
                if(err.response.status === 404){
                    getdisplayone.innerHTML = `
                        <div class="alert alert-danger text-center">No Data Found !!!</div>
                    `;
                getdisplaylistgroup.innerHTML = `
                    <li><a href="javascript:void(0);" class="dropdown-item">No Data</a></li>
                `;
                }
            })
        }

        function cardbodytodom(user){
            console.log(user);
            getdisplayone.innerHTML = `
                <img src="${user.avatar_url}" class="rounded-circle" width="100px"  alt="userimg" />
                <h3 class="card-title">${user.name}</h3>
                <p class="card-subtitle">${user.bio}</p>

                <ul class="list-group">
                    <li class="list-group-item">Repositories : <span class="fw-bold">${user.public_repos}</span> </li>
                    <li class="list-group-item">Followers : <span class="fw-bold">${user.followers}</span> </li>
                    <li class="list-group-item">Following : <span class="fw-bold">${user.following}</span> </li>

                </ul>
            `;

        }

        function resultrepos(username){
            // console.log(username);
            $.ajax({
                method: "GET",
                url:url+username+`/repos`,
                dataType: 'json'
            }).done((data)=>{
                // console.log(data);
                cardfootertodom(data);
            }).fail(()=>{
                console.log('error');
            });

        }

        function cardfootertodom(repositories){
            // console.log(repositories);

            getdisplaylistgroup.innerHTML = "";

            repositories.forEach(repository=>{
                console.log(repository);

                getdisplaylistgroup.innerHTML += `
                <li><a href="${repository.html_url}" class="dropdown-item" target="_blank">${repository.name}</a></li>
            `;
            })

            

        }

    </script>
    
</body>
</html>

<!-- 
Github Profile > GitHub Docs > Developers > REST API > Users > Users > Get the authenticated user
https://api.github.com/ 
-->